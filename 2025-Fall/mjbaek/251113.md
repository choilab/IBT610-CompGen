# ğŸ§¬ Lactobacillus fermentum Pangenome Analysis (Week Summary)

## ğŸ¯ Analysis Objective
ì´ë²ˆ ì£¼ì˜ ëª©í‘œëŠ” **Lactobacillus fermentum ê· ì£¼ì˜ ìœ ì „ì²´ ë‹¤ì–‘ì„±ì„ íŒê²Œë†ˆ(pangenome) ìˆ˜ì¤€ì—ì„œ ë¶„ì„í•˜ê³ , í´ëŸ¬ìŠ¤í„°ë§ëœ ìœ ì „ì ì§‘ë‹¨ì˜ ê¸°ëŠ¥ì„ ê·œëª…í•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤.  

ì´ë¥¼ ìœ„í•´ ë‹¤ìŒ ë‘ ë‹¨ê³„ë¥¼ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤:

1. **MMseqs2 ê¸°ë°˜ ìœ ì „ì²´ ë‹¨ë°±ì§ˆ í´ëŸ¬ìŠ¤í„°ë§**  
   â†’ ê· ì£¼ ê°„ ë‹¨ë°±ì§ˆ ì„œì—´ ìœ ì‚¬ì„±ì„ ê¸°ë°˜ìœ¼ë¡œ ìœ ì „ìêµ°(core/accessory) êµ¬ì¡° íŒŒì•…  
2. **Prokka & Roary ê¸°ë°˜ ê¸°ëŠ¥ ì£¼ì„(Functional Annotation)**  
   â†’ MMseqs2ë¡œ ì •ì˜ëœ ìœ ì „ìêµ°ì´ ì–´ë–¤ ìƒë¬¼í•™ì  ê¸°ëŠ¥ì„ ê°€ì§€ëŠ”ì§€ ë¶„ì„  

---

## âš™ï¸ 1. Data Preparation
- **ì´ˆê¸° ë¶„ì„ ëŒ€ìƒ:** ì´ **154ê°œ Lactobacillus fermentum ìœ ì „ì²´ (FASTA)**  
- **ë°ì´í„° í•„í„°ë§ ë° í’ˆì§ˆ ë³´ì • ì ˆì°¨:**
  -ì„œì—´ì ìœ¼ë¡œ ì™„ì „íˆ ë™ì¼í•œ ìƒ˜í”Œ 73ê°œ ì œê±° (ANI 100%, ì§€ë‚œì£¼ Lactobacillus fermentumì˜ metadataë¥¼ í™•ë³´í•  ìˆ˜ ìˆì—ˆë˜ ìˆ˜ì™€ ë™ì¼í•œ ìˆ˜)  
- **ìµœì¢… ë¶„ì„ ëŒ€ìƒ:** **83ê°œ ëŒ€í‘œ ê· ì£¼ FASTA íŒŒì¼**

---

## ğŸ§© 2. MMseqs2-Based Pangenome Clustering

### ğŸ”§ Workflow
1. **Input:** Prodigalë¡œ ì˜ˆì¸¡ëœ 81ê°œ ê· ì£¼ì˜ ë‹¨ë°±ì§ˆ ì„œì—´ (ëª¨ë“  ê· ì£¼ì˜ ë‹¨ë°±ì§ˆ ì„œì—´ ì§‘í•©ì„ í™•ë³´í•˜ì—¬ **MMseqs2 í´ëŸ¬ìŠ¤í„°ë§ ì…ë ¥ ë°ì´í„°ë¡œ ì‚¬ìš©**)
2. **Tool:** MMseqs2 (connected component mode)  
3. **Clustering ê¸°ì¤€:**  
   - pairwise similarity thresholdë¥¼ ë§Œì¡±í•˜ëŠ” ë‹¨ë°±ì§ˆì„ í•˜ë‚˜ì˜ clusterë¡œ ì—°ê²°  
   - ì—„ë°€í•œ ortholog clustering ë°©ì‹ì„ ì ìš©  
4. **Output Files:**
   - `representatives.fasta`: ê° í´ëŸ¬ìŠ¤í„°ì˜ ëŒ€í‘œ ë‹¨ë°±ì§ˆ ì„œì—´  
   - `clustered_sequences.fasta`: ê° í´ëŸ¬ìŠ¤í„° ë‚´ ì „ì²´ ë‹¨ë°±ì§ˆ ì„œì—´  
   - `adjacency_list.tsv`: ë‹¨ë°±ì§ˆâ€“cluster ë§¤í•‘ ì •ë³´  

---

### ğŸ“Š MMseqs2 Clustering Results

- Adjacency listë¥¼ ë°”íƒ•ìœ¼ë¡œ presence/absence ë§¤íŠ¸ë¦­ìŠ¤(`mmseq2_matrix_after.csv`) ìƒì„±
- **ê²°ê³¼íŒŒì¼**
- ê° clusterì˜ ì¡´ì¬ ë¹ˆë„(presence count)ì— ë”°ë¼ core gene ì •ì˜ (CSV íŒŒì¼ì„ Pandas DataFrameìœ¼ë¡œ ë¡œë“œí•´ ë¹ˆë„ ê³„ì‚°) 

| ê¸°ì¤€ | ì •ì˜ | Core gene ìˆ˜ |
|------|------|---------------|
| **100% (81 strains)** | Strict core | 0 |
| **â‰¥95% (â‰¥77 strains)** | Relaxed core | 1,278 |
| **â‰¥99% (â‰¥80 strains)** | Strict core | 1,037 |

ğŸ§  **Interpretation:**  
L. fermentum ê· ì£¼ ê°„ ìœ ì „ì  ë‹¤ì–‘ì„±ì´ ë§¤ìš° ë†’ìœ¼ë©°,  
ëª¨ë“  ê· ì£¼ì—ì„œ ê³µí†µì ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” ìœ ì „ìëŠ” ì—†ì—ˆì§€ë§Œ  
95~99% êµ¬ê°„ì—ì„œ ì•ˆì •ì ì¸ core gene ì§‘í•©ì´ í˜•ì„±ë¨ì„ í™•ì¸í•¨.  

**ê²°ê³¼ íŒŒì¼:**

---

## ğŸ§  3. Functional Annotation via Prokka & Roary

MMseqs2ë¥¼ í†µí•´ **ìœ ì „ì í´ëŸ¬ìŠ¤í„° êµ¬ì¡°ë¥¼ ì •ì˜í•œ í›„**,  
ê° ìœ ì „ìê°€ ì–´ë–¤ ìƒë¬¼í•™ì  ê¸°ëŠ¥ì„ ê°€ì§€ëŠ”ì§€ ë¶„ì„í•˜ê¸° ìœ„í•´ Prokkaì™€ Roaryë¥¼ í™œìš©í•¨.

### ğŸ”¹ Workflow
1. **Prokka annotation**  
   - 81ê°œ ìœ ì „ì²´ ê°ê°ì— ëŒ€í•´ Prokka ìˆ˜í–‰ â†’ `.gff` íŒŒì¼ ìƒì„±  
   - `CP021964.1.fasta`ëŠ” Galaxy ì—…ë¡œë“œ ì˜¤ë¥˜ë¡œ ì œì™¸ (So..80ê°œì˜ ë°ì´í„°ê°€ ë¨)
2. **Roary input generation**  
   - Prokkaì—ì„œ ìƒì„±ëœ `.gff` íŒŒì¼ì„ Roaryì— ì…ë ¥  
   - Pangenome ë‚´ ê° ìœ ì „ìì˜ ê¸°ëŠ¥ ë° ë¶„í¬ ë¹„ìœ¨ ê³„ì‚°  
3. **Output interpretation**  
   - Core, shell, cloud gene ë¹„ìœ¨ ë° ê¸°ëŠ¥ ì¹´í…Œê³ ë¦¬ë³„ í†µê³„ ì‚°ì¶œ  

---
**ê²°ê³¼íŒŒì¼: https://github.com/minjBaek02/file_collection/blob/7884c107bc9f3a2222dedf98aa5bb525d5efac28/Galaxy_Roary_Gene%20Presence%20Absence.csv**
### ğŸ“ˆ Roary Output Summary

| Category | Strain ê¸°ì¤€ (%) | Gene count |
|-----------|------------------|-------------|
| **Core genes** | 99â€“100% | **1,044** |
| **Soft core genes** | 95â€“99% | **132** |
| **Shell genes** | 15â€“95% | **1,541** |
| **Cloud genes** | 0â€“15% | **5,128** |
| **Total genes** | 0â€“100% | **7,845** |

---

### ğŸ’¡ Interpretation (Prokkaâ€“Roary)
- Roary ê²°ê³¼ëŠ” MMseqs2 ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ê³¼ ì¼ê´€ì„±ì„ ë³´ì´ë©°,  
  **core gene ìˆ˜ê°€ ì œí•œì ì´ê³  accessory geneì˜ ë¹„ìœ¨ì´ ë§¤ìš° ë†’ìŒ**ì„ í™•ì¸.  
- íŠ¹íˆ **shell + cloud geneì´ ì „ì²´ì˜ ì•½ 85% ì´ìƒ**ìœ¼ë¡œ, **L. fermentumì´ ë‹¤ì–‘í•œ í™˜ê²½ ì ì‘ì„±ì„ ê°€ì§€ëŠ” ì¢…** ì´ë¼ê³  ìƒê°í•  ìˆ˜ ìˆì„ ë“¯ í•¨.
- ì´í›„ core geneì— ëŒ€í•œ **GO/KEGG ê¸°ë°˜ ê¸°ëŠ¥ ë§¤í•‘**ì„ ì–´ë–¤ ê¸°ëŠ¥ì˜ ìœ ì „ìë“¤ì´ ê³µí†µì ìœ¼ë¡œ ë§ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì°¾ì•„ë³´ê³  ì‹¶ìŒ.
- ë˜í•œ, L. fermentumì˜ metadataë¡œ ê· ì´ ë¶„ë¦¬ëœ backgroundë¥¼ ê¸°ë°˜ìœ¼ë¡œ, fermented food, milk ë“± ì‹í’ˆìœ ë˜ì˜ ê· ì£¼ë¥¼ ì„ ë³„í•´ ë°œíš¨, ì¥ ë‚´ ê¸°ëŠ¥ì„±(ì¥ë¶€ì°©ì„±(biofilm ë“±)) ê´€ë ¨ ìœ ì „ì íƒìƒ‰ì´ ë‹¤ìŒ ì£¼ ëª©ì ì„.


---

## ğŸ§© 4. Summary of This Week

| êµ¬ë¶„ | ë¶„ì„ ë‚´ìš© | ì£¼ìš” ê²°ê³¼ |
|------|------------|------------|
| **Data Curation** | ì¤‘ë³µÂ·ì´ìƒì¹˜ ìƒ˜í”Œ ì œê±° | 154 â†’ 81 strains ìµœì¢… ì‚¬ìš© |
| **ë‹¨ë°±ì§ˆ í´ëŸ¬ìŠ¤í„°ë§** | MMseqs2 clustering | 95% ê¸°ì¤€ 1,278ê°œ core gene |
| **ê¸°ëŠ¥ ì£¼ì„ ë¶„ì„** | Prokka + Roary | 7,845ê°œ total genes, core 1,044 |
| **ìœ ì „ì  ë‹¤ì–‘ì„± í‰ê°€** | Whole-genome comparison | Core gene ë¹„ìœ¨ ë‚®ê³  accessory gene í’ë¶€ |
| **ë¶„ì„ ëª©ì  ë‹¬ì„±** | Core êµ¬ì¡° ë° ê¸°ëŠ¥ì  ì°¨ì´ ê·œëª… | âœ… ì™„ë£Œ |

---

## ğŸ§° Tools Used

| Tool | Description |
|------|--------------|
| **Prodigal** | CDS prediction (protein-coding gene extraction) |
| **MMseqs2** | Protein clustering (pangenome group definition) |
| **Prokka** | Genome annotation (Roary input generation) |
| **Roary** | Functional-based pangenome analysis |
| **Python (pandas, seaborn)** | Matrix transformation, visualization |



