# **Lactobacillus fermentum Pan-Genome Analysis Report**

## **1. Title**

**Construction of *Lactobacillus fermentum* gruping Based on Accessory Gene Clustering**

---

## **2. Objective**

본 프로젝트의 목적은 80개의 *Lactobacillus fermentum* 전체 유전체 데이터를 기반으로 **pan-genome 분석**을 수행하고, 특히 **accessory genome 기반의 클러스터링을 통해 phylogroup을 정의할 수 있는지 탐색**하는 것이다. 이를 위해 Roary, EggNOG-mapper 등의 도구를 활용하여 유전자의 보존 양상, 기능적 카테고리, 각 그룹의 기능적 특성을 분석하였다.

---

## **3. Background**

Lactobacillus fermentum은 유산균(Lactic Acid Bacteria, LAB) 계열에 속하는 그람양성 혐기성/통성혐기성 박테리아로, 다양한 발효식품(치즈, 김치, 요구르트 등)과 인간 및 동물의 점막(위장관, 구강, 비뇨생식계)에서 흔히 분리된다. 본 종은 다음과 같은 특성과 연구적/산업적 가치를 지닌다:

* **생태·응용적 중요성**: 전통 발효식품의 핵심 구성 미생물 중 하나로서 발효 특성, 유기산(주로 젖산) 생성, 엑소다당류(예: EPS) 생성, 그리고 항균물질(박테리오신) 합성 등으로 식품 품질 및 보존성에 영향을 준다.

* **프로바이오틱 잠재력**: 장벽 강화, 병원성 억제 및 면역조절과 관련한 여러 연구에서 프로바이오틱 특성이 보고되었다.

* **유전체 크기 및 유전정보**: 공개된 L. fermentum 완전체/초안 유전체의 평균 크기는 약 **~1.9–2.1 Mbp** 범위, 평균 CDS(예상 단백질 코딩 유전자) 수는 연구별로 **약 1,800–2,100개** 수준으로 보고된다. (유전체마다 편차가 있으므로 본 프로젝트에서는 **155개의 원시 genome**을 수집한 뒤 ANI 및 중복/이상치 필터링을 통해 최종 **80 genome**을 선정하여 Roary 분석에 사용하였다.)

* **유전적 다양성의 의미**: L. fermentum은 분리원(치즈, 발효채소, 유제품, 사람 유래 등)에 따라 accessory genome에서 큰 차이를 보이는 경향이 있어(Zhao, Yan, et al.2022), accessory genome에 대한 분석이 중요하다. (Zhao, Yan, et al.2022:https://doi.org/10.3390/foods11193135)


---

## **4. Input Data Summary**

* **ncbi에서 얻을 수 있는 총 genome 수**: 155
* **분석에 사용된 L. fermentum 유전자 정보**: 총 80개 (5.Workflow summary의 Step 1. 참조)

---

## **5. Workflow Summary**

### **Step 1. Genome Collection & Preprocessing**

* NCBI에서 *L. fermentum*의 전체 유전체 FASTA/GFF 파일 다운로드 -->155개
* ANI 결과를 활용하여 outlier 제거(중복 genome 및 비정상적 genome filtering) --> 80개

---

### **Step 2. Pan-genome Construction (Roary)**

사용 도구: **[Roary](https://github.com/sanger-pathogens/Roary)**

* 입력: 80개 유전자의 GFF (Prokka output)
* Roary 수행 후 생성된 파일 중 주요 파일:
  * `gene_presence_absence.csv`
  * `accessory_binary_genes.fa`
  * roary에서는 accessory gene을 soft-core gene을 포함해 accessory gene을 정의한다.
    
| Category            | 정의                     |
| ------------------- | ---------------------- |
| **Core genes**      | 모든 균주에서 ≥ 99% 존재하는 유전자 |
| **Soft-core genes** | 95–99%의 균주에서 존재하는 유전자  |
| **Shell genes**     | 15–95% 균주에서 존재         |
| **Cloud genes**     | ≤ 15% 균주에서 존재          |


하지만, soft-core(95–99%) 유전자가 거의 모든 균주에 존재하는 quasi-core gene에 해당하여 strain 간 기능적 차이나 niche-specific 적응을 설명하는 데 기여도가 낮다. 반면, shell과 cloud 유전자는 carbohydrate utilization,  acid resistance, stress-response modules 등과 같은 환경 적응 관련 기능이 집중적으로 분포하며,
이러한 고변이성 유전자군이 종 내 유전적 다양성과 발효 환경 적응을 결정하므로, 많은 pangenome 연구에서는 실질적인 accessory genome을 shell + cloud로 정의하여 분석하는 접근을 사용한다(Zhao et al., 2019.).
따라서, step 3.와 같이 shell+cloud genes만을 필터링 했다. 

---

### **Step 3. Accessory Matrix Extraction**

* `gene_presence_absence.csv`에서 **95% 미만 gene만 필터링** → accessory matrix 생성
* gene ID만 추출 → `accessory_gene.list` 생성
* accessory matrix 기반 → **Newick tree 생성** → `accessory_tree.nwk`
* ITOL에 업로드하여 accessory 기반 clustering tree 생성

특징:

* 특정 genome 하나가 accessory profile에서 많이 분리되어 떨어져 있었음 → niche-specific 기능 가능성

---

### **Step 4. Functional Annotation (EggNOG-mapper)**

사용 도구: **[EggNOG-mapper](https://github.com/eggnogdb/eggnog-mapper)**

EggNOG-mapper는 유전자 서열을 기반으로 기능을 빠르게 예측하는 고성능 기능 주석 도구이다.
직접적으로 orthology(직계 상동성) 정보를 활용해 유전자의 기능, COG 카테고리, 효소 기능, 대사 경로 정보를 자동으로 부여하며 대규모 microbiome 또는 비교유전체 분석에서 널리 사용된다.

주요 기능: COG functional category 자동 할당, GO term, KEGG pathway, Enzyme (EC) 번호 주석 등

* `accessory_gene.list`와 매칭하여 필요한 부분만 필터링 → `accessory_eggnog_annotations.tsv`

---

### **Step 5. COG Category Extraction & Profiling**

* COG (Clusters of Orthologous Groups): NCBI에서 구축한 정교한 ortholog 기반의 기능 분류 시스템
* 발효 미생물 관련 연구-Lactobacillus / Leuconostoc / Lactiplantibacillus 등 LAB(유산균) pan-genome 논문 대부분이 COG category heatmap을 사용하기에 참고하여 COG로 annotation 하였다.
* EggNOG annotation의 **COG functional category**를 사용
* 각 genome별 accessory gene에 대해 COG category counting → `genome_cog_category_counts.tsv`

**발효 관련 주요 COG category:**

* **C**: Energy production and conversion
* **G**: Carbohydrate transport and metabolism
* **E**: Amino acid transport and metabolism

참고 논문:

* Chun, Byung Hee, et al.2017: 발효 미생물에서 C, G, E category가 환경 적응 핵심 기능
* Heo, Sojeong, et al.2019: 발효 식품 기원 미생물에서 G, E 카테고리의 분포가 핵심 대사 특성 결정

---

### **Step 6. Visualization [iTOL](https://itol.embl.de)**

* accessory tree (Newick)
* COG category bar file 생성 → ITOL에 업로드
  
<img width="1006" height="740" alt="image" src="https://github.com/user-attachments/assets/85ee9e34-f37f-4b9e-87ea-300886f049e6" />

---

**Interpretation**

* 특정 phylogroup에서 **C/G/E 관련 COG category가 집중적으로 나타남** → 발효 및 환경 적응성이 높을 것임.
* Outlier strain은 고유 대사 기능(cloud genes 기반)을 갖고 있을 가능성이 있음.
* orphan gene(어떤 genome에도 cluster되지 않는 단독 gene)은 기능 미확인 gene(S/R category 다수)



---

## **7.**Metadata-based Source Annotation**

발효 관련 COG 기능군(C, G, E 등)이 높은 그룹이 실제 발효 환경에서 분리된 균주와 연관되는지 확인하기 위해 **분리원(Source) 메타데이터**를 활용하였다.

모든 균주를 다음 8개 카테고리로 분류하였다:  
**oral, dairy, fermented_food, human_organ, fecal, secretions, plant, food**

이 정보를 accessory gene 기반 클러스터링 트리와 함께 iTOL에서 색상(colorstrip)으로 시각화하여,  
특정 클러스터가 발효 식품(fermented_food, dairy, plant) 유래 균주 중심으로 구성되는지  
또는 비발효 환경(oral, human_organ, fecal 등)의 균주가 다른 기능적 패턴을 보이는지 비교하였다.

메타데이터 파일(`biosample_metadata_81_sort.csv`)은 iTOL colorstrip 형식에 맞게 txt로 변환한 뒤 트리에 적용하였다.

<img width="1179" height="763" alt="image" src="https://github.com/user-attachments/assets/f473b8b0-e5b1-45f8-ba10-6f0442986e9b" />


---

## **8. To Be Added Next**

* orphan gene functional analysis
* cluster별 대표 기능 heatmap
* phylogroup naming 기준(예: COG 패턴 기반)
* 지난 주 리포트 참고 링크 삽입

---

## **Appendix: COG Category Meaning**
(출처: NCBI; EGG-NOG MAPPER와 분류기준이 같음.)
| Code | Description |
|------|-------------|
| **A** | RNA processing and modification |
| **B** | Chromatin structure and dynamics |
| **C** | Energy production and conversion |
| **D** | Cell cycle control, cell division, chromosome partitioning |
| **E** | Amino acid transport and metabolism |
| **F** | Nucleotide transport and metabolism |
| **G** | Carbohydrate transport and metabolism |
| **H** | Coenzyme transport and metabolism |
| **I** | Lipid transport and metabolism |
| **J** | Translation, ribosomal structure and biogenesis |
| **K** | Transcription |
| **L** | Replication, recombination and repair |
| **M** | Cell wall/membrane/envelope biogenesis |
| **N** | Cell motility |
| **O** | Posttranslational modification, protein turnover, chaperones |
| **P** | Inorganic ion transport and metabolism |
| **Q** | Secondary metabolites biosynthesis, transport and catabolism |
| **R** | General function prediction only |
| **S** | Function unknown |
| **T** | Signal transduction mechanisms |
| **U** | Intracellular trafficking, secretion, vesicular transport |
| **V** | Defense mechanisms |
| **W** | Extracellular structures |
| **Y** | Nuclear structure |
| **Z** | Cytoskeleton |

