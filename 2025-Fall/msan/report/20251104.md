# Lactobacillus plantarum 대표 게놈 선별 

## 1. 프로젝트 배경 및 목표 (Rationale & Goals)

본 프로젝트는 `Lactobacillus plantarum`의 기능적 다양성을 균주(strain) 수준에서 깊이 있게 탐구하는 것을 목표로 합니다.

이를 위해, 공개 데이터베이스에 등록된 수많은 게놈 서열에서 중복을 제거하고, 후속 연구에 사용할 고품질의 **대표 게놈(Representative Genomes)** 세트를 선별하는 체계적인 파이프라인을 구축했습니다.

## 2. 분석 파이프라인 (Analysis Pipeline)

#### 2.1. 데이터 수집 (Data Acquisition)
- NCBI 데이터베이스에서 `Lactobacillus plantarum`의 **Chromosome-level**로 완성된 게놈 어셈블리만을 선별하여, 총 **359개**의 게놈을 확보하며 분석을 시작했습니다.

#### 2.2. 품질 평가 (Quality Assessment)
- **1차 QC (CheckM2)**: 수집된 359개 게놈의 완성도(Completeness)와 오염도(Contamination)를 평가하기 위해, Galaxy 플랫폼에서 **CheckM2** 분석을 수행하여 데이터의 신뢰도를 확보했습니다.
- **2차 QC (Assembly Metrics)**: 본 프로젝트에 포함된 Python 스크립트를 활용하여 각 게놈의 **N50**과 같은 주요 어셈블리 지표를 계산했습니다. 이 값들을 종합하여 각 게놈의 품질을 정량화한 `Quality_Score`를 산출했으며, 이 점수는 최종 대표 게놈 선정에 핵심 기준으로 사용되었습니다.

#### 2.3. 게놈 클러스터링 (Genome Clustering)
- **유사도 계산 (fastANI)**: 게놈 간의 중복성을 판단하기 위해, Python 스크립트를 통해 **fastANI**의 All-vs-All 비교를 자동화했습니다. 이를 통해 359개 게놈의 모든 쌍에 대한 **평균 염기서열 유사도(ANI)** 값을 계산했습니다.
- **임계값별 그룹화**: 스크립트는 ANI 값 98.0%부터 100.0%까지 다양한 임계값을 자동으로 적용하여, 각 기준에 따라 예상되는 대표 그룹의 수와 구성원을 요약한 결과를 생성했습니다.

## 3. 클러스터링 결과 및 최종 기준 선정

자동화된 분석을 통해 ANI 임계값에 따라 그룹 수가 어떻게 변하는지 명확하게 파악할 수 있었습니다. 이 데이터는 최종 대표 게놈 세트를 결정하는 데 중요한 근거가 되었습니다.

| ANI 임계값 (Threshold) | 생성된 그룹 수 | 대표 샘플 예시 (Top 2)                               | 비고                                     |
| :--------------------- | :------------- | :--------------------------------------------------- | :--------------------------------------- |
| 98.0%                  | 2              | GCF_041927215.1, GCF_003597635.1                     |                                          |
| 99.0%                  | 11             | GCF_041927215.1, GCF_049177195.1                     |                                          |
| 99.5%                  | 81             | GCF_050920835.1, GCF_041927215.1                     |                                          |
| 99.7%                  | 128            | GCF_042465735.1, GCF_041927215.1                     | 그룹 수 급감 시작                        |
| **99.9%**              | **214**        | **GCF_042465735.1, GCF_041927215.1**                 | ⬅️ **선택된 기준 (Selected Threshold)**    |
| 100.0%                 | 358            | GCF_042465735.1, GCF_018588615.2                     | 거의 모든 게놈이 독립 그룹 형성          |

**ANI 99.9%**를 최종 대표 균주 선별 기준으로 결정했습니다. 
   **신뢰성 있는 중복 제거**: 이 기준은 사실상 거의 동일한(near-identical) 게놈 서열만을 하나의 그룹으로 묶어주는 역할을 합니다. 이를 통해 데이터의 중복성은 효과적으로 제거하면서도, 균주 간의 유의미한 유전적 차이는 최대한 보존할 수 있습니다.

## 4. 최종 결과 (Final Outcome)

> 초기 데이터셋인 **359개**의 `Lactobacillus plantarum` 게놈은 체계적인 품질 평가와 ANI 99.9% 기준의 클러스터링을 통해, 최종적으로 **214개**의 고품질 대표 게놈으로 정제되었습니다.

